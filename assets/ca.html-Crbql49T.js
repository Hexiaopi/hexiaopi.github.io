import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a,b as e,o as t}from"./app-oq2zg2ZW.js";const o={},p=e(`<h2 id="安装工具" tabindex="-1"><a class="header-anchor" href="#安装工具"><span>安装工具</span></a></h2><blockquote><p>使用CloudFlare的PKI和TLS工具包cfssl来创建证书</p></blockquote><h3 id="安装cfssl工具集" tabindex="-1"><a class="header-anchor" href="#安装cfssl工具集"><span>安装cfssl工具集</span></a></h3><p>cfssl工具集中包含很多工具</p><blockquote><p>cfssl：证书签发工具</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>go get github.com/cloudflare/cfssl/cmd/cfssl
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>cfssljson：将cfssl生产的证书（json格式）变为文件承载式证书</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>go get github.com/cloudflare/cfssl/cmd/cfssljson
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>或者直接安装所有工具</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>go get github.com/cloudflare/cfssl/cmd/<span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="创建配置文件" tabindex="-1"><a class="header-anchor" href="#创建配置文件"><span>创建配置文件</span></a></h3><blockquote><p>CA配置文件是用来配置根证书的使用场景（profile）和具体参数（usage、过期时间、服务端认证、客户端认证、加密等） 创建文件：ca-config.json</p></blockquote><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;signing&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;default&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;expiry&quot;</span><span class="token operator">:</span> <span class="token string">&quot;87600h&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;profiles&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;iam&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;usages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token string">&quot;signing&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;key encipherment&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;server auth&quot;</span><span class="token punctuation">,</span>
                    <span class="token string">&quot;client auth&quot;</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token property">&quot;expiry&quot;</span><span class="token operator">:</span> <span class="token string">&quot;876000h&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>signing：表示该证书可用于签名其他证书（生成的ca.pem证书中的CA=TRUE）</li><li>server auth：表示client可以用该证书对server提供的证书进行验证</li><li>client auth：表示server可以用该证书对client提供的证书进行验证</li><li>expiry：876000h，证书有效期设置为100年</li></ul><h3 id="创建证书签名请求文件" tabindex="-1"><a class="header-anchor" href="#创建证书签名请求文件"><span>创建证书签名请求文件</span></a></h3><blockquote><p>用来生成CA证书签名请求（CSR）的JSON配置文件</p></blockquote><p>创建文件：ca-csr.json</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;CN&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test-ca&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;algo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rsa&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">2048</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;names&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;C&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CN&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;ST&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BeiJing&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;L&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BeiJing&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;O&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hexiaopi&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;OU&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ca&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;expiry&quot;</span><span class="token operator">:</span> <span class="token string">&quot;876000h&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>C：Country，国家</li><li>ST：State，省份</li><li>L：Locality or City，城市</li><li>CN：Common Name，浏览器使用该字段验证网站是否合法</li><li>O：Organization，组织</li><li>OU：Company Division，部门/单位</li></ul><h3 id="创建ca证书和私钥" tabindex="-1"><a class="header-anchor" href="#创建ca证书和私钥"><span>创建CA证书和私钥</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>cfssl gencert <span class="token parameter variable">-initca</span> ca-csr.json <span class="token operator">|</span> cfssljson <span class="token parameter variable">-bare</span> ca
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>上述命令会创建运行CA所必须的文件<code>ca-key.pem</code>（私钥）和 <code>ca.pem</code>（证书），还会生成<code>ca.csr</code>(证书签名请求)，用于交叉签名或重新签名。</p>`,22);function i(l,c){return t(),n("div",null,[a(" more "),p])}const d=s(o,[["render",i],["__file","ca.html.vue"]]),m=JSON.parse('{"path":"/tools/ca.html","title":"CA证书","lang":"zh-CN","frontmatter":{"title":"CA证书","date":"2023-08-14T00:00:00.000Z","tag":["工具"],"category":["工具"],"head":[["meta",{"property":"og:url","content":"http://blog.cjhe.top/tools/ca.html"}],["meta",{"property":"og:site_name","content":"个人博客"}],["meta",{"property":"og:title","content":"CA证书"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-05T15:52:14.000Z"}],["meta",{"property":"article:author","content":"Hexiaopi"}],["meta",{"property":"article:tag","content":"工具"}],["meta",{"property":"article:published_time","content":"2023-08-14T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-05T15:52:14.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"CA证书\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-08-14T00:00:00.000Z\\",\\"dateModified\\":\\"2024-05-05T15:52:14.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hexiaopi\\",\\"url\\":\\"https://github.com/Hexiaopi\\"}]}"]]},"headers":[{"level":2,"title":"安装工具","slug":"安装工具","link":"#安装工具","children":[{"level":3,"title":"安装cfssl工具集","slug":"安装cfssl工具集","link":"#安装cfssl工具集","children":[]},{"level":3,"title":"创建配置文件","slug":"创建配置文件","link":"#创建配置文件","children":[]},{"level":3,"title":"创建证书签名请求文件","slug":"创建证书签名请求文件","link":"#创建证书签名请求文件","children":[]},{"level":3,"title":"创建CA证书和私钥","slug":"创建ca证书和私钥","link":"#创建ca证书和私钥","children":[]}]}],"git":{"createdTime":1647866740000,"updatedTime":1714924334000,"contributors":[{"name":"hexiaopi","email":"hechangjie0619@icloud.com","commits":2},{"name":"HeXiaoPi","email":"hechangjie0619@icloud.com","commits":1}]},"readingTime":{"minutes":1.39,"words":418},"filePathRelative":"tools/ca.md","localizedDate":"2023年8月14日","excerpt":""}');export{d as comp,m as data};
